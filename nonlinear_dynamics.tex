\documentclass[oneside]{book}

\input{note_header.tex}
\input{emre_header.tex}

\begin{document}
\begin{titlepage}
\vspace*{\fill}
\begin{center}
{\Huge{\textbf{Nonlinear Dynamics}}}\\[2cm]
{\Large{Emre Ã–zer}\\[0.4cm]}
Summer 2019 \\
\vspace{4mm}
      Notes based on the book \textit{``Nonlinear Dynamics and Chaos''} \\by STEVEN H. STROGATZ. 
\end{center}
\vspace*{\fill}
\end{titlepage}

\tableofcontents

\chapter{Introduction}
\section{Dynamical Systems}
Dynamics is the subject that deals with systems that \textit{evolve in time.} There are two main types of dynamical systems:
\begin{enumerate}
	\item Differential equations.
	\item Iterated maps (difference equations).
\end{enumerate}
Differential equations describe systems with \textit{continuous time evolution,} whereas iterated maps describe \textit{discrete evolution.} We will focus on differential equations.
\par
The general form for an \textit{autonomous} system governed by ordinary differential equations is:
\begin{equation} \label{eq:111}
\dot{x}_i = f_i (x_1, x_2, \ldots, x_n), \quad i \in \{1, 2, \ldots, n \}.
\end{equation}
We may denote the set of variables $ (x_1, x_2, \ldots, x_n) $ as a vector $ \vec{x} $. Later on, this will also emphasize that the system, at any given time, is described by a \textit{vector in the phase space}.
\\\\
\fbox{
\begin{minipage}{\textwidth}
	\begin{example}[Damped oscillator] A damped oscillator in one dimension has an equation of motion of the form:
	\[
	m \ddot{x} = -kx - \gamma \dot{x},
	\]
	so we let $ x_{1} = x $ and $ x_{2} = \dot{x} $. Hence, the system becomes
	\begin{align*}
	\dot{x}_{1} &= x, \\
	\dot{x}_{2} &= -\frac{k}{m} x_{1} - \frac{\gamma}{m} x_{2}.
	\end{align*}
	\end{example}
\end{minipage}
}
\begin{definition}[Linear system] A dynamical system of the form \eqref{eq:111} is said to be \textit{linear} if $ f_i (\vec{x}) $ is linear in $ x_j $ for all $ i $ and $ j $.
\end{definition}
\begin{definition}[Nonlinear system] A system is said to be \textit{nonlinear} if it is not linear.
\end{definition}
\par Nonlinear systems are very difficult to solve \textit{analytically}. Usually, analytic solutions do not exist simply due to the fact that we do not have enough special functions. But, we don't need an analytic solution to describe such systems, we know qualitatively how a pendulum moves around the top and etc. There should be a way of extracting such information without an analytic solution. So, we will use geometrical methods in the \textit{phase space} of the system.
\\
\fbox{
\begin{minipage}{\textwidth}
\begin{minipage}{0.6\textwidth}
	\example[Pendulum] A pendulum with length $ \ell $ and mass $ m $ has the Lagrangian
	\[
	\mathcal{L}(\theta, \dot{\theta}) = \tfrac{1}{2} m (\ell \dot{\theta})^2 + mg \ell \cos \theta
	\]\[
	\implies \pdv{\mathcal{L}}{\dot{\theta}} = m \ell ^2 \dot{\theta}, \quad \pdv{\mathcal{L}}{\theta} = -mg \ell \sin\theta.
	\]
	Hence, the equation of motion reads
	\[
	\ddot{\theta} + \frac{g}{\ell} \sin \theta = 0.
	\]
	To write this in the form \eqref{eq:111}, we let $ x_1 = \theta $ and $ x_2 = \dot{\theta} $:
	\begin{align*}
	\dot{x}_{1} &= x_{2}, \\
	\dot{x}_{2} &= -\frac{g}{\ell} \sin x_1.
	\end{align*}
	So, we see that the equivalent system is \textit{nonlinear.}
\end{minipage} \hfill
\begin{minipage}{0.4 \textwidth}
	\centering
	\begin{tikzpicture}[scale=1.5]
	\draw[dashed] (0,0) -- (0,-3); 
	\draw[thick] (-1,0) -- (1, 0);
	%\node at (0,0) [circle, fill, inner sep=1pt] {};
	\foreach \x in {0,...,5}
		\draw (\x / 2.77 - 1, 0) -- (\x / 2.77 - 1 + 0.2, 0.2);
	\draw (0,0) -- ( {3 * cos(60)}, {-3 * sin(60)});
	\node at ({3 * cos(60)}, {-3 * sin(60)}) [circle, fill, inner sep=3pt] {};
	\draw (0,-0.8) arc (-90:-60:0.8);
	\node at (0.22, -0.9) {$ \theta $};
	\end{tikzpicture}
\end{minipage}
\end{minipage}
}
\section{Phase Spaces and Trajectories}
A solution to the pendulum system given some initial conditions is some pair of functions $ x_1 (t) $ and $ x_2 (t) $. Notice that on a space with coordinates $ (x_1, x_2) $, the solution corresponds to a \textit{curve.}
\begin{definition}[Phase space]
	The phase space for the general system \eqref{eq:111} is the space with coordinates $ x_1, x_2, \ldots, x_n $. This is an $ n^{\text{th}} $ order (or an $n$ dimensional) system.
\end{definition}
\begin{definition}[Trajectory]
	The curve $ x_i (t) $ traced out by a solution to a given system is called a \textit{trajectory.}
\end{definition}
\par
Our goal is to draw trajectories for a given system without solving the differential equations.
\begin{figure}[h!]
\centering
\includegraphics[width=0.5 \textwidth]{figs/121.png}
\caption{Some phase trajectory.}
\end{figure}
\begin{definition} [Autonomous system]
	If the differential equations governing a system have no explicit time dependence (such as a driving force), the system is said to be \textit{autonomous}. \eqref{eq:111} is an autonomous system.
\end{definition}
\begin{definition}[Non-autonomous system]
	If a system is not autonomous, it is non-autonomous. This means $ f_i (\vec{x}, t) $ has time dependence \textit{for some $ i $}.
\end{definition}
Any non-autonomous system can be made to be autonomous by introducing time as a new variable to the system. Given an $ n $-dimensional non-autonomous system, let $ x_{n+1} = t $. Then, we have
\[
\dot{x}_i = \begin{cases} f_i (\vec{x}, x_{n+1}) & \text{for } i \in \{1, 2, \ldots, n\}, \\
1 & \text{for } i = n+1.
\end{cases}
\]
which is \textit{autonomous}. \\\\
\fbox{
	\begin{minipage}{\textwidth}
		\begin{example}[Forced harmonic oscillator]
			Consider a forced harmonic oscillator, with a forcing term of the form $\vec{F}(t) = \vec{F} \cos t $. Let us work in one dimension, in which case the equation of motion reads
			\[
				m\ddot{x} + k x + \gamma \dot{x} = F \cos t.
			\]
			This is \textit{traditionally} a second order, linear, non-homogenous differential equation. We will, however, treat it as a third order nonlinear system by letting $ x_1 = x $, $ x_2 = \dot{x} $ and $ x_3 = t $. The system is now
			\begin{align*}
				\dot{x}_1 &= x_2, \\
				\dot{x}_2 &= \tfrac{1}{m} \qty(-kx_1 - \gamma x_2 + F \cos x_3), \\
				\dot{x}_3 &= 1.
			\end{align*}
		\end{example}
	\end{minipage}
}
\part{One Dimensional Flow}
\chapter{Flows on the Line}
We start with a one dimensional system, governed by the equation
\begin{equation} \label{eq:201}
\dot{x} = f(x),
\end{equation}
for some smooth function $ f $.
\begin{definition}[One-dimensional / first order systems]
	Systems of the form \eqref{eq:201}.
\end{definition}
Note that here ``system'' refers to a dynamical system, not a physical system. Also, $ f $ cannot have any time dependence or otherwise the system would be two-dimensional.
\section{Geometric Approach}
The main idea is to treat the differential equation as a \textit{vector field} in the phase space.
\par
Consider the equation
\begin{equation} \label{eq:211}
\dot{x} = \sin x.
\end{equation}
The analytical solution exists, but is complicated:
\begin{equation} \label{eq:212}
	t = \log \abs{\frac{\csc x_0 + \cot x_0}{\csc x + \cot x}}.
\end{equation}
By looking at \eqref{eq:212}, try to answer the following simple questions
\begin{enumerate}
	\item Suppose $ x_0  = \pi / 4$, what happens \textit{qualitatively}  to $ x(t) $ as $ t \to \infty $?
	\item For an \textit{arbitrary} $ x_0 $, what is the behaviour of the system as $ t \to \infty $?
\end{enumerate}
It now becomes clear that \eqref{eq:212} is not very helpful. Yet, we may simply read off the answers to the questions by plotting $ \dot{x} $ as a function of $ x $.
\begin{figure}[h]
	\centering
	\includegraphics[width=0.8\textwidth]{figs/211.png}
	\caption{Phase portrait of \eqref{eq:211}}
\end{figure}
\par
Think of $ t $ as time, $ x $ as the position of a particle moving along the $ x $-axis and $ \dot{x} $ its velocity. Whenever $ \dot{x} > 0 $, the particle moves right, and if $ \dot{x} < 0 $ it moves left. When $ \dot{x} = 0 $, it remains stationary. The equation \eqref{eq:211} represents a \textit{vector field on the line.}
\par
Points where $ \dot{x} = 0 $ are fixed points. There are two kinds: \textit{stable (or attractor)} represented by solid dots, and \textit{unstable (or repeller)} represented by open circles. This plot on the phase space is called a \textit{phase portrait.}
\par
Now, the answers to the questions become almost trivial.
\section{Fixed Points and Stability}
\begin{definition} [Fixed point]
	Given a general system of the form \eqref{eq:111}, a fixed point denoted $ \vec{x}^* $ is defined such that
	\[
		\dot{x}_i = f_i (\vec{x}^*) = 0 \qq{for all \textit{i}.}
	\]
	In a one dimensional system, we have
	\[
	\dot{x} = 0 \implies f(x^*) = 0.
	\]
\end{definition}
In terms of the differential equation, fixed points represent \textit{equilibrium} solutions. An equilibrium is defined to be \textit{stable} if all sufficiently small disturbances away from it damp out in time. 
\begin{definition}[Locally stable fixed point]
	In an \textit{n}-dimensional system, a fixed point $ \vec{x}^* \in \R^n$ is said to be \textit{locally stable} if, given an initial condition $ x(t=0) = \vec{x}^* + \vec{\eta} $, there exists $ \epsilon > 0 $ such that the limit $ \displaystyle\lim_{t \to \infty} x(t) = \vec{x}^* $ for all $ \vec{\eta} $ where $ \abs{\vec{x} - \vec{\eta}} < \epsilon $.
\end{definition}
\begin{definition}[Unstable fixed point]
	A fixed point is \textit{unstable} if it is not locally stable.
\end{definition}
\noindent\fbox{
	\begin{minipage}{\textwidth}
		\begin{minipage} {0.5\textwidth}
			\begin{example}
				Consider the system 
				\[
				\dot{x} = x - \cos x.
				\]
				If we plot $ \dot{x} = x $ and $ \dot{x} = \cos x $ separately, we see that when $ x $ lies above the cosine, the flow is to the right. Otherwise, the flow is towards the left. At the intersection, we see that there is an \textit{unstable} fixed point. The fixed point is given by
				\[
				x^* = \cos x^*.
				\]
			\end{example}
		\end{minipage} \hfill
		\begin{minipage} {0.5\textwidth}
				\centering
				\includegraphics[width=\textwidth]{figs/212.png}
		\end{minipage}
	\end{minipage}
}
\section{Linear Stability Analysis}
Apart from graphical methods, we may \textit{linearize} our system about fixed points to get quantitative results about their stability. Let $ \eta(t) \equiv x(t) - x^* $ be a small perturbation. Then, we have
\[
x(t) = \eta(t) + x^* \implies \dot{x} = \dot{\eta} = f(\eta + x^*) = f(x^*) + \eta f^\prime(x^*) + o(\eta),
\]
where we have assumed that $ f $ is continuously differentiable in the neighbourhood of $ x^* $. For small $ \eta $ we obtain a differential equation:
\begin{equation} \label{eq:231}
	\dot{\eta} = \eta f^\prime (x^*).
\end{equation}
Now, we see $ \eta(t) $ grows exponentially if $ f^\prime(x^*) > 0 $, and decays exponentially if $ f^\prime(x^*) < 0 $. In the borderline case $ f^\prime(x^*) = 0 $, linearization does not tell us anything.
\par
The magnitude of $ f^\prime(x^*) $ gives us a characteristic decay (or growth) rate near $ x^* $.
\\\\
\fbox{
	\begin{minipage}{\textwidth}
		\begin{example}[Logistic equation]
			The logistic equation describes population growth, with growth rate per capita decreasing linearly as population increases - due to limited resources etc.
			\par
			The equation is
			\[
				\dot{x} = r x \qty(1 - \frac{x}{K}),
			\]
			where $ r $ and $ K $ are the growth rate and carrying capacity, both of which are positive. The fixed points are $ x^* = 0 $ and $ x^* = K $. We have
			\[
			f^\prime(0) = r, \quad f^\prime(K) = -r,
			\]
			hence $ x^* = 0 $ is unstable and $ x^* = K $ is stable. In both cases, the characteristic rate of change is $ r $ - as expected.
		\end{example}
	\end{minipage}
}
\chapter{Bifurcations}
We may introduce parameters which we can vary continuously on systems. This results in interesting properties, such as fixed points being created or destroyed, or their stability changed. Such qualitative changes in the behaviour of a system are called \textit{bifurcations.} The parameter causing the bifurcation is called \textit{bifurcation parameter.} The value of the bifurcation parameters at which the bifurcation occurs is called the \textit{bifurcation point.}
\\\\
\noindent\fbox{
	\begin{minipage}{\textwidth}
		\begin{minipage}{0.4\textwidth}
		\begin{example}[Buckling of beam]
			If a weight is placed on top of a beam, depending on its weight the beam can either support it upright or buckle. A previously stable solution becomes unstable and two new stable solutions appear. This is a (pitchfork) bifurcation.
		\end{example}
	\end{minipage}\hfill
	\begin{minipage}{0.55\textwidth}
		\centering
		\includegraphics[width=\textwidth]{figs/301.png}
	\end{minipage}
	\end{minipage}
}
\section{Saddle-Node Bifurcation}
This is the basic mechanism by which fixed points are created and destroyed. Consider the system
\begin{equation} \label{eq:311}
\dot{x} = r + x^2 \qq{for some $ r \in \R $}.
\end{equation}
The fixed points are given by
\[
0 = r + (x^*) ^ 2 \implies x^* = \pm \sqrt{-r}.
\]
Since $ x $ is a real variable, this suggests that no fixed points exist for $ r > 0 $, when $ r = 0 $ there is a single fixed point \textit{(with weird stability)} and for $ r < 0 $, a stable and an unstable fixed point exists. The stability is obvious from the plots - see \autoref{fig:311}.
\begin{figure}[h]
	\centering
	\includegraphics[width=\textwidth]{figs/311.png}
	\caption{Normal form saddle-node bifurcation.}
	\label{fig:311}
\end{figure}
\par
We may treat $ r $ as an \textit{independent variable} and plot the fixed point $ x^* $. This is called a \textit{bifurcation diagram}, see \autoref{fig:312}. To distinguish between stable and unstable fixed points, we use a solid line for stable points and a dashed line for unstable ones.
\begin{figure}[h]
	\centering
	\includegraphics[width=0.5\textwidth]{figs/312.png}
	\caption{Bifurcation diagram for \eqref{eq:311}.}
	\label{fig:312}
\end{figure}
\\
\fbox{
	\begin{minipage}{\textwidth}
		\begin{example}[Saddle-node bifurcation]
			Consider the system
			\[
				\dot{x} = r - x - e^{-x} \implies r = x^* + e^{-x^*}.
			\]
			Instead of plotting the bifurcation diagram, an easier approach is to plot $ \dot{x} $, by plotting $ r - x $ and $ e^{-x} $. When they intersect, we have $ r - x = e^{-x} $ which is a fixed point. We may also infer the flow by the positions of the curves. 
			\includegraphics[width=\textwidth]{figs/313.png}
			To find the bifurcation point $ r_c $, we impose the condition $ r-x $ and $ e^{-x} $ intersect \textit{tangentially.} This is a characteristic of saddle-node bifurcations in one dimensional systems. Hence, we require
			\[
				e^{-x} = r - x, \qq{and} \tdv{}{x} e^{-x} = \tdv{}{x} (r - x), \implies r_c = 1.
			\]
		\end{example}
	\end{minipage}
}
\subsection{Normal forms}
We may classify bifurcations by \textit{``how the system looks like close to the the bifurcation'',} meaning the local properties of the system close to a bifurcation point and the phase position at which the bifurcation occurs. These are known as \textit{normal forms}, and for a saddle-point bifurcation they are
\begin{equation}
\dot{x} = r \pm x^2.
\end{equation}
Let's see how we can obtain this normal form by imposing the tangency condition (as $ r $ is varied $ \dot{x} $ must intersect $ x $ tangentially. Consider $ f(x) $ as a function of $ x $ and $ r $. Expanding around $ (x^*, r_c) $ yields
\[
f(x,r) = f(x^*, r_c) + (x - x^*) \eval{\pdv{f}{x}}_{x^*, r_c} + (r - r_c) \eval{\pdv{f}{r}}_{(x^*, r_c)} + \tfrac{1}{2} (x - x^*)^2 \eval{\pdv[2]{f}{x}}_{(x^*, r_c)} + \ldots
\]
Now, we note that $ f(x^*, r_c) $ is a fixed point. By tangency condition, $ \pdv*{f}{x} = 0 $ at $ (x^*, r_c) $. With the first two terms zero and ignoring higher terms, we obtain the normal form.
\section{Transcritical Bifurcation}
Some fixed points may exist for all values of a parameter in a given system. However, such a fixed point may change its stability as the parameter is varied. Such a bifurcation is called \textit{transcritical.}
\par
The normal form for a transcritical bifurcation is
\begin{equation} \label{eq:321}
	\dot{x} = rx - x^2.
\end{equation}
This looks like the logistic equation, but we are not limited to non-negative $ x $ and $ r $. \autoref{fig:321} shows the system for different values of $ r. $
\begin{figure}[h]
	\centering
	\includegraphics[width=0.8\textwidth]{figs/321.png}
	\caption{Transcritical bifurcation in one dimension.}
	\label{fig:321}
\end{figure}
\par
Note that $ x^* = 0 $ is a fixed point for all $ r $. The fixed point is stable for $ r < 0 $, and unstable for $ r > 0 $. Hence, in its normal form \eqref{eq:321}, the bifurcation occurs at $ r_c = 0 $.
\\\\
\fbox{
	\begin{minipage}{\textwidth}
		\begin{example}
			The system $ \dot{x} = x (1 - x^2) - a(1 - e^{-bx}) $ undergoes a transcritical bifurcation at $ x = 0 $ when $ ab = 1 $. This defines a \textit{bifurcation curve} in the $ (a,b) $ parameter space. To see this, we expand $ f(x) $ around $ x = 0 $,
			\[
				\dot{x} = (1 - ab)x + \frac{ab^2}{2}x^2 + \order{x^3},
			\]
			hence bifurcation occurs if $ ab = 1. $ We know this must be a transcritical bifurcation because around $ x = 0, $ it satisfies the normal form. Note that $ x^* = 0 $ is a fixed point for all $ a $ and $ b $.
		\end{example}
	\end{minipage}
}
\par
\autoref{fig:322} shows the bifurcation diagram for the transcritical bifurcation in its normal form. We see that $ x = r $ is an unstable fixed point for $ r < 0 $, and stable for $ r > 0 $. The opposite is true for $ x = 0 $.
\begin{figure}[h]
	\centering
	\includegraphics[width=0.5\textwidth]{figs/322.png}
	\caption{Bifurcation diagram for the normal form of transcritical bifurcation.}
	\label{fig:322}
\end{figure}
\section{Pitchfork Bifurcation}
This is common in physical problems that have \textit{symmetry}. Fixed points appear and disappear in symmetrical pairs. There are two kinds of pitchfork bifurcation: \textit{supercritical} and \textit{subcritical.}
\subsection{Supercritical pitchfork bifurcation}
The normal form of the supercritical pitchfork bifurcation is
\begin{equation} \label{eq:331}
	\dot{x} = rx - x^3.
\end{equation}
Note the $ x \to - x $ symmetry of the system.
\begin{figure}[h]
	\centering
	\includegraphics[width=0.9\textwidth]{figs/331.png}
	\caption{Supercritical pitchfork bifurcation in one dimension.}
	\label{fig:331}
\end{figure}
\par
We see from \autoref{fig:331} that for $ r < 0 $, $ x^* = 0 $ is the only fixed point and is stable. At $ r = 0 $, $ x^* = 0 $ is still stable but solutions do not decay exponentially to $ x = 0 $ in its neighborhood. The decay is polynomial, so much slower. This slow decay is called \textit{critical slowing down} in physics. When $ r > 0 $, the origin is unstable but two new stable fixed points appear at $ x^* = \pm \sqrt{r} $. The bifurcation diagram is plotted on \autoref{fig:332}.
\begin{figure}[h]
	\centering
	\includegraphics[width=0.5\textwidth]{figs/332.png}
	\caption{Bifurcation diagram for supercritical pitchfork.}
	\label{fig:332}
\end{figure}
\\\\
\fbox{
	\begin{minipage}{\textwidth}
		\begin{example}
			The system $ \dot{x} = -x + \beta \tanh x $ exhibits a supercritical pitchfork bifurcation. Plot it!
		\end{example}
	\end{minipage}
}
\subsection{Subcritical pitchfork bifurcation}
In the supercritical case, the cubic term ($ -x^3 $ in equation \eqref{eq:331}) is stabilizing. The flow is ``pulled'' to the centre due to it. If instead, the cubic term were destabilizing such that
\begin{equation} \label{eq:332}
	\dot{x} = rx + x^3,
\end{equation}
then we would have a \textit{subcritical} pitchfork bifurcation. The bifurcation diagram is shown on \autoref{fig:333}.
\begin{figure}[h]
	\centering
	\includegraphics[width=0.5\textwidth]{figs/333.png}
	\caption{Bifurcation diagram for subcritical pitchfork bifurcation in one dimension.}
	\label{fig:333}
\end{figure}
\\
\fbox{
	\begin{minipage}{\textwidth}
		\begin{example}
			Consider the system $ \dot{x} = rx + x^3 - x^5 $. The fifth term prevents the system from blowing up to infinity. We would expect a subcritical pitchfork bifurcation at $ x = 0 $. At $ x^* = 0 $, we always have a fixed point. It is stable if $ r < 0 $, and unstable if $ r > 0 $. Excluding $ x^* = 0 $, we have
			\[
				r + x^2 - x^4 = 0 \implies r = x^4 - x^2.
			\]
			Note that the minimum value of $ r $ is $ r_{\text{min}} = -\tfrac{1}{4} $. Hence, for $ r < - \tfrac{1}{4} $ we expect a single fixed point at $ x = 0 $, which is stable. After explicitly solving for $ x $ or plotting $ \dot{x}(x, r) $ we see that if $ -\tfrac{1}{4} < x < 0 $, there are 4 more fixed points, two of which are stable. Finally, for $ r > 0 $, the two unstable fixed points disappear. We may plot a bifurcation diagram, which looks interesting.
		\end{example}
	\end{minipage}
}
\fbox{
	\begin{minipage}{0.5 \textwidth}
		Imagine moving along the $ r$-axis. The state remains at the origin until $ r = 0 $, when the origin loses stability. The state will jump to one of the stable branches. If $ r $ is now decreased, the state remains on the large-amplitude branch, even when $ r $ is decreased below 0! We have to lower $ r $ even further to get the state to jump back to the origin. This lack of reversibility as a parameter is varied is called \textit{hysteresis}.
		\par
		At the turning point, there is a \textit{saddle-point bifurcation}. Stable and unstable fixed points are created in pairs.
	\end{minipage} \hfill
	\begin{minipage}{0.5\textwidth}
		\centering
		\begin{tikzpicture}[scale=0.6]
		\draw (-5, -5) -- (-5,5) node [right] {$ x $};
		\node at (-5.4,0) {$ 0 $};
		\draw[very thick] (-5, 0) -- (0,0);
		\draw[dashed] (0,0) -- (5,0) node [right] {$ r $};
		\node at (0.2,-0.4) {$ 0 $};
		\draw [dashed, domain=-1.414:1.414] plot ({(\x*\x*\x*\x - 4*\x*\x)}, 2*\x);
		\draw [very thick, domain=-1.414:-2.2] plot ({(\x*\x*\x*\x - 4*\x*\x)}, 2*\x);
		\draw [very thick, domain=1.414:2.2] plot ({(\x*\x*\x*\x - 4*\x*\x)}, 2*\x);
		\end{tikzpicture}
	\end{minipage}
}
\section{Imperfect Bifurcations}
Perfect symmetries led to pitchfork bifurcations, but in many real systems there is a slight asymmetry due to imperfections. Consider the system
\begin{equation} \label{eq:341}
	\dot{x} = h + rx - x^3.
\end{equation}
When $ h = 0 $, we have a supercritical pitchfork bifurcation. However, for $ h \neq 0 $ the $ x \to -x $ symmetry is broken. Hence, $ h $ is called an \textit{imperfection parameter.}
\par
Since we have two independent parameters, this is a bit harder to analyse. First, consider varying $ h $ for fixed $ r $. Plotting $ y = rx - x^3 $ and $ y = -h $, the intersections would occur at fixed points of \eqref{eq:341}. When $ r \leq 0 $, there is only one fixed point; however, when $ r > 0 $ three fixed points may occur depending on the value of $ h $. This is the interesting regime. These plots are shown on \autoref{fig:341}.
\begin{figure}[h]
	\centering
	\includegraphics[width=0.8\textwidth]{figs/341.png}
	\caption{Plot of system \eqref{eq:341} at fixed $ r $ with different $ h $.}
	\label{fig:341}
\end{figure}
\par
At $ \abs{h} = h_c $, we obtain a saddle-node bifurcation. We may find $ h_c $ by noting that the two curves intersect tangentially. The local maximum of $ rx - x^3 $ occur at $ x_\text{max} = \pm \sqrt{r/3} $, hence
\[
\pm h_c (r) = \abs{r x_{\text{max}} - x_\text{max}^3} = \frac{2r}{3}\sqrt{\frac{r}{3}}.
\]
So, equation \eqref{eq:341} has 3 fixed points for $ \abs{h} < h_c{r} $ and 1 fixed point otherwise. We may plot the \textit{bifurcation curves} $ \pm h_c(r) $ on the $ (r, h) $ plane - see \autoref{fig:342}. Such plots are called \text{stability diagrams} - they show different behaviour as we move in \textit{parameter space}. The two bifurcation curves separate the plane into two regions. A saddle-point bifurcation occurs along the boundary. The bifurcation curves meet tangentially at the origin - this is called a \textit{cusp point.} At the cusp point, a \textit{codimension-2 bifurcation} takes place (meaning we had to tune two parameters instead of one).
\begin{figure}[h]
	\centering
	\includegraphics[width=0.5\textwidth]{figs/342.png}
	\caption{Stability diagram for an imperfect pitchfork bifurcation.}
	\label{fig:342}
\end{figure}
\par
We may also draw bifurcation diagrams for fixed $ h $ - see \autoref{fig:343}.
\begin{figure}[h]
	\centering
	\includegraphics[width=0.7\textwidth]{figs/343.png}
	\caption{Bifurcation diagram for fixed $ h $.}
	\label{fig:343}
\end{figure}
\par
Alternatively, we can plot $ x^* $ vs. $ h $ for fixed $ r $, \autoref{fig:344}.
\begin{figure}[h]
	\centering
	\includegraphics[width=0.6\textwidth]{figs/344.png}
	\caption{Plot of $ x^* $ vs. $ h $ for fixed $ r $.}
	\label{fig:344}
\end{figure}
\chapter{Flows on the Circle}
We now consider equations of the form
\begin{equation} \label{eq:401}
	\dot{\theta} = f(\theta),
\end{equation}
where $ \theta $ \textit{(phase)} corresponds to a point on the circle. For the vector field defined by \eqref{eq:401} to be well-defined and smooth, we require $ f(\theta) $ to be $ 2 \pi - $periodic and smooth. For instance, $ \dot{\theta} = \sin \theta $ is a valid system on the circle whereas $ \dot{\theta} = \theta $ is not.
\\\\
\fbox{
	\begin{minipage}{\textwidth}
		\begin{example}
			Consider $ \dot{\theta} = \cos \theta $. Fixed points occur at $ \cos \theta^* = 0 $.  One fixed point is stable $ \theta^* = \tfrac{1}{2} \pi $ and the other is unstable $ \theta^* = \tfrac{3}{2} \pi $.
		\end{example}
	\end{minipage}
}
\section{Uniform Oscillator}
The simplest system is when the phase $ \theta $ changes with a constant rate $ \omega $, so we have
\begin{equation} \label{eq:411}
	\dot{\theta} = \omega \Rightarrow \theta = \omega t + \theta_0,
\end{equation}
which corresponds to uniform motion around the circle at an angular frequency $ \omega $. This is the simplest periodic system. 
\par
Note that there is no amplitude variable in our system, since the system is one-dimensional. We only have the phase of an oscillating system.
\section{Nonuniform Oscillator}
Consider the system
\begin{equation} \label{eq:421}
	\dot{\theta} = \omega - a \sin \theta.
\end{equation}
Now, the angular frequency varies with the phase, with mean $ \omega $. For $ \omega $ and $ a $ positive, the flow is fastest at $ \theta = - \pi / 2$ and slowest at $ \theta = \pi / 2 $.
\par
As $ a $ approaches $ \omega $, the system takes a long time to pass through a \textit{bottleneck} around $ \pi / 2 $. When $ a = \omega $, a saddle-node bifurcation occurs at $ \pi / 2 $ and the system no longer oscillates. This behaviour is obvious from a $ (\theta, \dot{\theta}) $ plot.
\subsection{Oscillation period}
For $ a < \omega $. we may calculate the oscillation period analytically. It is given by
\[
T = \int dt = \int_{0}^{2\pi} \dv{t}{\theta} d\theta = \int_0^{2\pi} \frac{d\theta}{\omega - a \sin \theta}.
\]
We may evaluate this integral using contours. Let $ \gamma $ be the unit circle contour on the complex plane. Then, we have the parameterisation
\[
z = e^{i\theta} \Rightarrow dz = i z d\theta, \quad \sin \theta = \frac{1}{2i} \qty[z - \frac{1}{z}].
\]
The period is then given by the contour integral
\[
T = \oint_\gamma \frac{dz}{-\tfrac{a}{2}z^2 + i \omega z + \tfrac{a}{2}} = \frac{2 \pi}{\sqrt{\omega ^ 2 - a ^ 2}}.
\]
We see that we retain the period for the uniform oscillator when $ a = 0 $. As $ a \to \omega $, the period blows up. The order of divergence is
\[
T(a \to \omega^{-}) = \frac{2\pi}{\sqrt{\omega + a} \sqrt{\omega - a}} \approx \frac{2\pi}{\sqrt{2\omega}} (\omega - a)^{-1/2}.
\]
Hence, $ T $ diverges with a \textit{square-root scaling law}.
\subsection{Ghosts and bottlenecks}
The square-root scaling is a general feature of systems close to a saddle-node bifurcation. Just before the fixed points appear, the \textit{``ghost''} of the saddle-node bifurcation leads to slow passage through the bottleneck.
\par
The system spends almost all its time getting through the bottleneck as $ a \to \omega^- $. We look at the behaviour of $ \dot{\theta} $ in the vicinity of the minimum. We may work with the normal form for a saddle-node;
\begin{equation} \label{eq:422}
	\dot{x} = r + x^2,
\end{equation}
where $ r \ll 1 $ and $ r > 0 $. 
\par
Now, we want characteristic length and time scales, then the period will be on the order of the characteristic time. Suppose $ x $ has a characteristic scale $ \order{r^a} $ for some $ a $. Let $ x = r^a u $ where $ u \sim \order{1} $. Similarly suppose $ t = r^b \tau $ with $ \tau \sim \order{1} $. Then, our system \eqref{eq:422} becomes
\[
\dot{x} = r + x^2 \implies \dv{u}{\tau} \dv{\tau}{t} \dv{x}{u} = r^{a - b} \dv{u}{\tau} = r + r^{2a} u^2.
\]
Note that $ u $ and $ \tau $ are dimensionless variables, hence the terms $ du / d\tau $ and $ u^2 $ form dimensionless groups. For dimensional consistency, we require all the terms to be of the same order in $ r $, therefore
\[
a - b = 1 \wedge 2a = 1 \implies a = \frac{1}{2}, \,\, b = -\frac{1}{2}.
\]
The characteristic time scale is of order $ \tau \sim \order{r^{-1/2}} $, showing the square root scaling.
\par
We may arrive at the same result by considering the time it takes for the system to travel from $ x \to - \infty $ to $ x \to \infty $,
\[
T \sim \infint \frac{dx}{\dot{x}} = \infint \frac{dx}{r + x^2} = \frac{\pi}{\sqrt{r}} = \order{r^{-1/2}}.
\]
\fbox{
	\begin{minipage}{\textwidth}
		\begin{example}
			Consider the system \eqref{eq:421} in the limit $ a \to \omega ^- $ around the point $ \theta = \pi / 2 $:
			\[
			\dot{\theta} = \omega - a \sin \theta = (\omega - a) - \tfrac{1}{2}(\theta - \tfrac{\pi}{2})^2 (a \sin \tfrac{\pi}{2}) + \order{(\theta - \pi / 2)^3}.
			\]
			Let $ \phi \equiv \theta - \pi / 2 $, $ x = \sqrt{a/2} \phi $ and $ r = \omega - a $, then
			\[
			\dot{\phi} = \omega - a + \tfrac{1}{2}a \phi^2 +\order{\phi^3} \Leftrightarrow (2/a)^{1/2} \dot{x} = r + x^2 + \order{x^3}.
			\]
			Then, the period is given by
			\[
			T \sim \infint \frac{dx}{\dot{x}} = \qty(\frac{2}{a})^{1/2} \infint \frac{dx}{r + x^2} = \qty(\frac{2}{a})^{1/a} \frac{\pi}{\sqrt{r}} \approx \qty(\frac{2}{\omega})^{1/2} \frac{\pi}{\sqrt{\omega - a}},
			\]
			which agrees exactly with our previous result.
		\end{example}
	\end{minipage}
} 
\fbox{
	\begin{minipage} {0.7\textwidth}
		\begin{example}[Overdamped pendulum under constant torque]
			Consider a pendulum driven by a constant torque $ \Gamma $. First, let's write the Lagrangian.
			\[
			\mathcal{L}(\theta, \dot{\theta}) = T(\dot{\theta}) - V(\theta) + F^\text{ext} \theta
			\]
			where we are adding the constant torque in the form of a driving force. Then,
			\[
			\mathcal{L} = \frac{1}{2} m (\ell \dot{\theta})^2 - mg \ell \cos \theta + \Gamma \theta.
			\]
			The equation of motion, with the non-variational damping is given by
			\[
			\gamma \dot{\theta} = \fdv{\mathcal{L}}{\theta} = \Gamma - mg \ell \sin \theta - m \ell^2 \ddot{\theta}.
			\]
			In the overdamped limit, we ignore the $ \ddot{\theta} $ term. Non-dimensionalizing the equation, we obtain
			\[
			\dv{\theta}{\tau} = \xi - \sin \theta,
			\]
			where $ \tau \equiv mg\ell t / \gamma $ and $ \xi \equiv \Gamma / mg\ell $. We see that $ \xi $ is the ratio of the driving torque to the maximum gravitational torque. When $ \xi > 1 $, the pendulum can overturn periodically. As $ \xi \to 1^+ $, it takes longer to complete its motion around $ \theta = \pi / 2 $, so we have a bottleneck. At $ \xi = 1 $, a saddle-point bifurcation occurs at $ \theta = \pi  /2 $ and the system behaves as we would expect.
		\end{example}
	\end{minipage} \hfill
	\begin{minipage}{0.3 \textwidth}
		\centering
		\includegraphics[width=0.8\textwidth]{figs/421.png}
		\includegraphics[width=0.8\textwidth]{figs/422.png}
	\end{minipage}
}
\part{Two Dimensional Flows}
\chapter{Linear Systems}
\section{Introduction}
In higher dimensions a much wider range of dynamical behaviour is possible. Linear systems are the simplest, but they play an important role in the classification of fixed points of nonlinear systems.
\begin{definition}[Two-dimensional linear system]
	Is a system of the form
	\begin{align} \label{eq:511}
	\begin{split}
		\dot{x} &= ax + by \\
		\dot{y} &= cx + dy,
	\end{split}
	\end{align}
	where $ a, b, c, d $ are parameters. We may write \eqref{eq:511} in matrix form
	\begin{equation} \label{eq:512}
		\dot{\vec{x}} = A \vec{x},
	\end{equation}
	where $ A = \mqty(a & b \\ c & d) $ and $ \vec{x} = \mqty(x \\ y). $
\end{definition}
Since the system is linear, given two solutions $ \vec{x}_1 $ and $ \vec{x}_2 $, \textit{any linear combination} $ c_1 \vec{x}_1 + c_2 \vec{x}_2 $ is also a solution. Furthermore, for any linear system
\[
\vec{x} = \vec{0} \implies \dot{\vec{x}} = \vec{0}.
\]
Hence $ \vec{x}^* = \vec{0} $ is \textit{always} a fixed point.
\par
The solutions of $ \dot{\vec{x}} = A \vec{x} $ can be visualised as trajectories moving on the $ (x, y) $ \textit{phase plane}.
\begin{example}
	Consider the system $ \dot{\vec{x}} = A\vec{x} $, with $ A = \mqty(a & 0 \\ 0 & -1) $ and $ \vec{x} = \mqty(x \\ y) $. We may solve this uncoupled system analytically,
	\begin{align*}
		\dot{\vec{x}} = a x &\implies x(t) = x_0 e^{at}, \\
		\dot{\vec{y}} = - y &\implies y(t) = y_0 e^{-t}.
	\end{align*}
	The phase plane vector field is defined by $ (\dot{x}, \dot{y}) = (ax, -y) $. 
	\begin{figure}[h]
		\centering
		\includegraphics[width=0.8\textwidth]{figs/511.png}
	\end{figure}
\par
When $ a < 0 $, $ \vec{x}^* = \vec{0} $ is a \textit{stable node}. In the special case $ a = -1 $, $ \vec{x}^* $ is called a \textit{symmetrical node} or a \textit{star}. The direction of approach to the fixed point as $ t \to + \infty $ is along the \textit{slow} axis. In the case $ a < -1 $, the $ x $ component decays faster, so the trajectories approach $ \vec{x}^* $ along the \textit{y}-axis. The opposite happens for $ -1 < a < 0 $.
\par
When $ a = 0 $, we have an entire \textit{line of fixed points} along the \textit{x}-axis. 
\par
Finally, when $ a > 0 $, $ \vec{x}^* $ is \textit{unstable} due to the exponential growth in the \textit{x}-direction. In forward time, trajectories are asymptotic to the \textit{x}-axis and in backward time to the \textit{y}-axis. Here $ \vec{x}^* = \vec{0} $ is a \textit{saddle-point}. The \textit{y}-axis is called the \textit{stable manifold} of the saddle point $ \vec{x}^* $, defined as the set of initial conditions $ \vec{x}_0 $ such that $ \vec{x}(t) \to \vec{x}^* $ as $ t \to + \infty $. Likewise, the \textit{unstable manifold} of $ \vec{x}^* $ is the set of initial conditions such that $ \vec{x}(t) \to \vec{x}^* $ as $ t \to - \infty $. A typical trajectory asymptotically approaches the unstable manifold as $ t \to +\infty $, and approaches the stable manifold as $ t \to - \infty $.
\end{example}
\subsection{Stability definitions}
For all the following definitions, let $ \vec{x}^* $ be a fixed point of some system $ \dot{\vec{x}} = \vec{f}(\vec{x}) $.
\begin{definition}[Attracting fixed point]
	$ \vec{x}^* $ is \textit{attracting} if there exists $ \delta > 0 $ such that 
	\[
	\lim_{t \to \infty} \vec{x}(t) = \vec{x}^* 
	\]
	for all initial conditions satisfying $ \abs{\vec{x}(0) - \vec{x}^*} < \delta $. So, any trajectory that starts within a distance $ \delta $ of $ \vec{x}^* $ if guaranteed to converge to $ \vec{x}^* $ \textit{eventually}.
\end{definition}
\begin{definition}[Lyapunov stable]
	$ \vec{x}^* $ is \textit{Lyapunov stable} if for any $ \epsilon > 0 $ there exists $ \delta > 0 $ such that $ \abs{\vec{x}(t) - \vec{x}^*} < \epsilon $ for all $ t \geq 0 $ and $ \abs{\vec{x}(0) - \vec{x}^*} < \delta $.
	\par
	So, trajectories that start within $ \delta $ of $ \vec{x}^* $ remain within $ \epsilon $ of $ \vec{x}^* $ for all positive time.
\end{definition}
\begin{definition}[Asymptotically stable] $ \vec{x}^* $ is \textit{asymptotically stable} if it is both \textit{attracting} and \textit{Lyapunov stable.} 
\end{definition}
\begin{definition}[Globally attractive] If $ \vec{x}^* $ is attracting for all point on the phase plane, it is \textit{globally attractive}. 
\end{definition}
\begin{definition}[Neutrally stable]
	If $ \vec{x}^* $ is Lyapunov stable but not attracting, it is \textit{neutrally stable.}
\end{definition}
\begin{definition} [Unstable]
	If $ \vec{x}^* $ is neither attracting nor Lyapunov stable, then it is \textit{unstable}.
\end{definition}
\begin{note}[Graphical convention]
	Open dots denote unstable fixed points, solid black dots denote Lyapunov stable fixed points.
\end{note}
\begin{figure}[h]
	\centering
	\includegraphics[width=0.7\textwidth]{figs/524.png}
	\caption{Attracting (left) and Lyapunov stable (right).}
\end{figure}
\section{Classification of Fixed Points}
For a general linear system, the equations will not be uncoupled. We seek solutions of the form
\begin{equation} \label{eq:521}
\dot{\vec{x}}(t) = e^{\lambda t} \vec{v}.
\end{equation}
For a given $ \vec{v} \neq 0 $, any phase space trajectory that starts on the subspace spanned by $ \vec{v} $\textit{ (which is a line on the phase space,)} will never leave it.
\par
Combining the equations \eqref{eq:512} and \eqref{eq:521} yields
\[
\dot{\vec{x}} = A \vec{x} \implies \lambda e ^ {\lambda t} \vec{v} = A e^{\lambda t} \vec{v}.
\]
Hence we obtain the eigenvalue problem
\begin{equation} \label{eq:522}
	A \vec{v} = \lambda \vec{v}.
\end{equation}
The characteristic equation yields
\[
\lambda^ 2 - \tau \lambda + \Delta = 0,
\]
where $ \Delta \equiv \det(A) $ and $ \tau \equiv \tr(A) $. The eigenvalues are then given by
\begin{equation} \label{eq:523}
	\lambda _ {\pm} = \frac{\tau \pm \sqrt{\tau^2 - 4 \Delta}}{2}.
\end{equation}
For distinct eigenvalues, the eigenvectors are linearly independent. Hence, \textit{any} initial condition can be written as a linear combination of the eigenvectors. So, we immediately obtain the general solution:
\[
\vec{x}_0 = c_1 \vec{v}_1 + c_2 \vec{v}_2 \implies \vec{x}(t) = c_1 e^{\lambda_1 t} \vec{v}_1 + c_2 e^{\lambda_2 t} \vec{v}_2.
\]
\begin{definition}[Saddle point]
	When the eigenvalues are real and have opposite signs, the corresponding fixed point is a \textit{saddle point.}
\end{definition}
\begin{figure}[h]
	\centering
	\includegraphics[width=0.3\textwidth]{figs/521.png}
	\caption{Phase portrait of a typical saddle point.}
\end{figure}
\begin{definition}[Stable node]
	When both eigenvalues are real and negative, the fixed point is a \textit{stable node.}
\end{definition}
\begin{figure}[h]
	\centering
	\includegraphics[width=0.4\textwidth]{figs/522.png}
	\caption{Phase portrait of a typical stable node.}
\end{figure}
\begin{definition}[Unstable node]
	When both eigenvalues are real and positive, the fixed point is an \textit{unstable node}.
\end{definition}
\begin{example}
	Consider the system $ \dot{x} = x + y $, $ \dot{y} = 4x - 2y $. Written in matrix form, 
	\[ 
	\dot{\vec{x}} = A \vec{x} \qq{with}  A = \mqty(1 & 1 \\ 4 & -2).
	\] 
	By \eqref{eq:523}, the eigenvalues are
	\[
	\lambda_1 = 2, \quad \lambda_2 = -3.
	\]
	Two eigenvectors are
	\[
	\vec{v}_1 = \mqty(1 \\ 1), \quad \vec{v}_2 = \mqty(1 \\ -4).
	\]
	The trajectories decay along $ \vec{v}_2 $ and grow along $ \vec{v}_1 $. The fixed point is a saddle point.
\end{example}
\subsection{Centres and spirals}
If the eigenvalues are not real, then the fixed point is either a \textit{centre} or a \textit{spiral}. Complex eigenvalues occur when $ \tau^2 - 4 \Delta < 0 $. 
\par
Let $ \lambda_{\pm} = \alpha \pm i \omega $ where $ \alpha \equiv \tau / 2 $ and $ \omega \equiv \tfrac{1}{2}\sqrt{4\Delta - \tau^2} $. The solution is then given by
\[
\vec{x}(t) = e^{\alpha t} \qty(c_1 e^{i\omega t} \vec{v}_1 + c_2 e^{-i \omega t} \vec{v}_2).
\]
When $ \alpha = 0 $, the fixed point is a \textit{centre} and trajectories are closed orbits. For $ \alpha > 0 $, the trajectories exponentially grow so we get an \textit{unstable spiral}. Likewise, when $ \alpha < 0 $, we have \textit{stable spirals.} The fixed point is attracting and Lyapunov stable for $ \alpha < 0 $, neutrally stable for $ \alpha = 0 $ and unstable for $ \alpha > 0 $. 
\begin{figure}[h]
	\centering
	\includegraphics[width=0.5\textwidth]{figs/523.png}
	\caption{Phase portraits of a centre (left) and a stable spiral (right).}
\end{figure}
\subsection{Degenerate eigenvalues}
Suppose $ \lambda_1 = \lambda_2 = \lambda $. If there are two linearly independent eigenvectors, the matrix $ A $ must be of the form $ A = \lambda \mathbb{I} $. To see this, note that the existence of two linearly independent eigenvectors with the same eigenvalue implies that any vector is an eigenvector. The solutions are
\[
\vec{x}(t) = e^{\lambda t} \vec{x}_0,
\]
so trajectories are straight lines through the origin and the fixed point is a \textit{star.} If $ \lambda > 0 $, the origin is unstable and if $ \lambda < 0 $ it is stable.
\par
The other possibility is that there is only one eigenvector. In such a case, the fixed point is a \textit{degenerate node}. There is only one direction of approach. As $ t \to \pm \infty $, trajectories become parallel to the single eigenvectors. One way to think of a degenerate node is as the limit of the two eigenvectors of a regular node approaching each other. Some of the trajectories will get squished between the two eigenvectors, while surviving trajectories get pulled around.
\begin{figure}[h]
	\centering
	\includegraphics[width=0.7\textwidth]{figs/525.png}
	\caption{Degenerate node as a limit of the eigenvectors of a node approaching each other.}
\end{figure}
\par
A degenerate node is on the \textit{borderline between a spiral and a node.} 
\subsection{General classification scheme}
The only information we need to classify the fixed points are the eigenvalues, which obey the relations:
\begin{equation}
	\lambda_{1,2} = \frac{1}{2} \qty( \tau \pm \sqrt{\tau^2 - 4 \Delta} ), \quad \Delta = \lambda_1 \lambda_2, \quad \tau = \lambda_1 + \lambda_2,
\end{equation}
where $ \tau $ and $ \Delta $ are the trace and determinant of the matrix $ A $. The second and third relations are implied by the characteristic equation:
\[
(\lambda - \lambda_1)(\lambda - \lambda_2) = \lambda^2 - \tau \lambda + \Delta = 0.
\]
\begin{figure}[h]
	\centering
	\includegraphics[width=0.7\textwidth]{figs/526.png}
	\caption{Classifications of fixed points on a trace-determinant diagram.}
\end{figure}

















\end{document}

\begin{figure}[h]
	\centering
	\begin{tikzpicture}[scale=0.6]
	\draw[dashed] (0, 0) -- (5, 0) node [right] {unstable};
	\node at (4.6,-0.5) {$ r $};
	\draw (0, -5) -- (0, 5) node [right] {$ x $};
	\draw[dashed, domain=0:-5] plot (\x,{sqrt(-\x)}) node [left] {unstable};
	\draw[dashed, domain=0:-5] plot (\x,-{sqrt(-\x)}) node [left] {unstable};
	\draw[very thick] (0,0) -- (-5,0) node [left] {stable};
	\end{tikzpicture}
\end{figure}
\begin{figure}
	\centering
	\begin{tikzpicture}[scale=0.6]
	\draw (-5, -5) -- (-5,5) node [right] {$ x $};
	\node at (-5.4,0) {$ 0 $};
	\draw[very thick] (-5, 0) -- (0,0);
	\draw[dashed] (0,0) -- (5,0) node [right] {$ r $};
	\node at (0.2,-0.4) {$ 0 $};
	\draw [dashed, domain=-1.414:1.414] plot ({(\x*\x*\x*\x - 4*\x*\x)}, 2*\x);
	\draw [very thick, domain=-1.414:-2.2] plot ({(\x*\x*\x*\x - 4*\x*\x)}, 2*\x);
	\draw [very thick, domain=1.414:2.2] plot ({(\x*\x*\x*\x - 4*\x*\x)}, 2*\x);
	\end{tikzpicture}
\end{figure}

































